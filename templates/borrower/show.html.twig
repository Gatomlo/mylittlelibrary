{% extends 'base.html.twig' %}

{% block title %}Emprunteur{% endblock %}

{% block body %}
    <h1>Emprunteur</h1>

    <table class="table">
        <tbody>
            <tr>
                <th>Id</th>
                <td>{{ borrower.id }}</td>
            </tr>
            <tr>
                <th>Prénom</th>
                <td>{{ borrower.firstname }}</td>
            </tr>
            <tr>
                <th>Nom</th>
                <td>{{ borrower.lastname }}</td>
            </tr>
            <tr>
                <th>Mail</th>
                <td>{{ borrower.mail }}</td>
            </tr>
            <tr>
                <th>Téléphone</th>
                <td>{{ borrower.phone }}</td>
            </tr>
            <tr>
                <th>Implantation</th>
                <td>{{ borrower.implantation }}</td>
            </tr>
            <tr>
                <th>Département</th>
                <td>{{ borrower.department }}</td>
            </tr>
        </tbody>
    </table>

    <h3>Historique</h3>
    <table id="table_id" class="table">
      <thead>
        <tr>
          <th>Titre</th>
          <th>Date d'emprunt</th>
          <th>Remise prévue</th>
          <th>Date de retour</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
      {% for rental in borrower.rentals %}
        {% for book in rental.bookRentals %}
          <tr>
            <td><a href="{{path('book_show', {'id':book.id})}}">{{book.book.title}}</a></td>
            <td>{{book.rental.locationDate|date('d-m-Y')}}</td>
            <td>{{book.dueDate|date('d-m-Y') }}</td>
            {% if book.returnDate is not null%}
              <td>{{book.returnDate|date('d-m-Y') }}</td>
            {% else %}
              <td><span class="badge bg-danger"> Non rendu !</span></td>
            {% endif %}
            <td><a class="btn btn-primary" href="{{ path('rental_show', {'id': book.rental.id}) }}"><i class="fas fa-eye"></i></a></td>
          </tr>
        {% endfor %}
      {% endfor %}
      </tbody>
    </table>

    <a class="btn btn-primary" href="{{ path('borrower_index') }}">Retour</a>

    <a class="btn btn-primary" href="{{ path('borrower_edit', {'id': borrower.id}) }}">Editer</a>

    {{ include('borrower/_delete_form.html.twig') }}
{% endblock %}
{% block javascript %}
  <script>
    $(document).ready( function () {
      $('#table_id').DataTable();
    } );
  </script>
{% endblock %}
